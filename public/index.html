<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pure Coco | L'Art de l'Eau</title>
    <meta name="description" content="Single-origin Nam Hom coconut water. Hydration elevated. Impact accelerated.">

    <!-- Fonts: Inter & Playfair Display -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500&family=Playfair+Display:ital,wght@0,400;0,500;0,600;1,400;1,500&display=swap" rel="stylesheet">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'coco-linen': '#F5F2EB', /* Warmer, premium base */
                        'hydro-teal': '#4FC7D9',
                        'deep-forest': '#0F1F18', /* Richer black-green */
                        'champagne': '#D8C8B0', /* Luxury accent */
                        'obsidian': '#121212',
                        'glass-border': 'rgba(255, 255, 255, 0.15)',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                    },
                    letterSpacing: {
                        'editorial': '0.3em',
                    },
                    cursor: {
                        'none': 'none',
                    }
                }
            }
        }
    </script>

    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* LUXURY BASICS */
        body {
            background-color: #F5F2EB;
            color: #0F1F18;
            overflow-x: hidden;
            cursor: default; /* Replaced with custom cursor later if desired, keeping default for usability */
        }

        /* FILM GRAIN TEXTURE */
        .noise-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none;
            z-index: 50;
            opacity: 0.04;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
        }

        /* SCROLLBAR HIDDEN FOR CLEAN LOOK */
        ::-webkit-scrollbar {
            width: 0px;
            background: transparent;
        }

        /* WEBGL */
        #webgl-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }

        /* GLASSMORPHISM REFINED */
        .glass-panel {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(40px);
            -webkit-backdrop-filter: blur(40px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 20px 80px -10px rgba(0,0,0,0.05);
        }
        
        .glass-panel-dark {
            background: rgba(15, 31, 24, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            color: #F5F2EB;
        }

        /* TYPOGRAPHY UTILS */
        .reveal-text {
            will-change: transform, opacity;
        }
        
        .blend-mode-overlay {
            mix-blend-mode: overlay;
        }

        /* CUSTOM LOADER */
        .loader-line {
            width: 0%;
            height: 1px;
            background-color: #0F1F18;
            transition: width 1s ease-in-out;
        }
    </style>
</head>
<body class="antialiased selection:bg-champagne selection:text-deep-forest">

    <!-- Noise Texture -->
    <div class="noise-overlay"></div>

    <!-- Loading Screen -->
    <div id="loader-overlay" class="fixed inset-0 z-[100] flex flex-col items-center justify-center bg-coco-linen transition-opacity duration-1000">
        <div class="text-center space-y-4">
            <h2 class="text-xs font-sans tracking-editorial uppercase text-deep-forest">Pure Coco</h2>
            <div class="w-32 h-[1px] bg-champagne/30 mx-auto overflow-hidden">
                <div class="loader-line h-full w-full bg-deep-forest"></div>
            </div>
        </div>
    </div>

    <!-- WebGL Canvas -->
    <canvas id="webgl-canvas"></canvas>

    <!-- Navigation (Minimalist) -->
    <nav class="fixed w-full z-40 top-0 p-8 md:p-12 mix-blend-difference text-coco-linen" id="navbar">
        <div class="flex justify-between items-center">
            <a href="#" class="text-xl md:text-2xl font-serif italic font-medium tracking-wide">Pure.</a>
            
            <div class="hidden md:flex space-x-16 text-[10px] font-bold tracking-editorial uppercase">
                <a href="#product" class="hover:text-champagne transition-colors duration-500">Collection</a>
                <a href="#impact" class="hover:text-champagne transition-colors duration-500">Mission</a>
                <a href="#coach" class="hover:text-champagne transition-colors duration-500">Consult</a>
            </div>

            <a href="#shop" class="text-[10px] font-bold tracking-editorial uppercase border-b border-transparent hover:border-coco-linen transition-all duration-500 pb-1">
                Reserve
            </a>
        </div>
    </nav>

    <!-- 1. HERO SECTION -->
    <section id="hero" class="relative h-screen flex flex-col items-center justify-center overflow-hidden">
        <div class="absolute inset-0 flex flex-col items-center justify-center text-center px-4 z-10 pointer-events-none">
            
            <!-- Super-scale typography behind the can -->
            <h1 class="text-[14vw] leading-[0.8] font-serif text-deep-forest opacity-10 blur-sm absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 whitespace-nowrap">
                EAU DE VIE
            </h1>

            <div class="relative z-20 space-y-6">
                <p class="text-[9px] md:text-[11px] font-semibold tracking-editorial uppercase text-deep-forest/60 opacity-0 reveal-text">
                    Nam Hom — Single Origin
                </p>
                <h2 class="text-5xl md:text-8xl font-serif text-deep-forest opacity-0 reveal-text leading-tight">
                    <span class="italic font-light block text-4xl md:text-6xl mb-2">The Art of</span>
                    Hydration
                </h2>
                
                <div class="pt-8 opacity-0 reveal-text">
                    <p class="text-xs font-serif italic text-deep-forest/50">Scroll to explore</p>
                </div>
            </div>
        </div>
    </section>

    <!-- 2. BENEFITS (Liquid Glass Aesthetic) -->
    <section id="benefits" class="relative min-h-screen py-32 flex items-center z-10">
        <div class="max-w-7xl mx-auto px-6 w-full grid grid-cols-1 md:grid-cols-12 gap-16 items-center">
            <!-- Spacer for Can -->
            <div class="hidden md:block md:col-span-6 h-full"></div>
            
            <!-- Content -->
            <div class="md:col-span-6 glass-panel p-16 rounded-sm opacity-0 benefit-card border-l-0 border-r-0 border-b-0 border-t border-champagne/30">
                <span class="text-[10px] uppercase tracking-editorial text-champagne mb-6 block">Composition</span>
                <h2 class="text-5xl font-serif mb-12 text-deep-forest italic">Nature's Isotonic</h2>
                
                <div class="grid grid-cols-1 gap-12">
                    <div class="group cursor-pointer">
                        <div class="flex items-baseline justify-between border-b border-deep-forest/5 pb-4 mb-2 transition-all duration-700 group-hover:border-deep-forest/30">
                            <h3 class="text-sm font-sans uppercase tracking-widest text-deep-forest/80">Electrolytes</h3>
                            <span class="text-xl font-serif italic text-deep-forest">600mg+</span>
                        </div>
                        <p class="text-xs text-deep-forest/50 font-serif italic group-hover:text-deep-forest transition-colors duration-700">
                            Potassium rich. Sourced from the young green coconut.
                        </p>
                    </div>
                    
                    <div class="group cursor-pointer">
                        <div class="flex items-baseline justify-between border-b border-deep-forest/5 pb-4 mb-2 transition-all duration-700 group-hover:border-deep-forest/30">
                            <h3 class="text-sm font-sans uppercase tracking-widest text-deep-forest/80">Purity</h3>
                            <span class="text-xl font-serif italic text-deep-forest">100%</span>
                        </div>
                        <p class="text-xs text-deep-forest/50 font-serif italic group-hover:text-deep-forest transition-colors duration-700">
                            Zero additives. Zero compromise. Bottled at source.
                        </p>
                    </div>

                     <div class="group cursor-pointer">
                        <div class="flex items-baseline justify-between border-b border-deep-forest/5 pb-4 mb-2 transition-all duration-700 group-hover:border-deep-forest/30">
                            <h3 class="text-sm font-sans uppercase tracking-widest text-deep-forest/80">Vessel</h3>
                            <span class="text-xl font-serif italic text-deep-forest">Al ∞</span>
                        </div>
                        <p class="text-xs text-deep-forest/50 font-serif italic group-hover:text-deep-forest transition-colors duration-700">
                            Infinitely recyclable aluminum. A promise to the ocean.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 3. IMPACT STORY (Minimalist Grid) -->
    <section id="impact" class="relative min-h-screen py-32 flex flex-col justify-center z-10">
        <div class="max-w-7xl mx-auto px-6 w-full">
            <div class="flex flex-col md:flex-row justify-between items-end mb-24 border-b border-deep-forest/10 pb-8">
                <div>
                    <span class="text-champagne text-[9px] tracking-editorial uppercase font-bold mb-4 block">The Initiative</span>
                    <h2 class="text-6xl md:text-8xl font-serif text-deep-forest">Hydrate One.<br><span class="italic text-deep-forest/40">Fund Two.</span></h2>
                </div>
                <div class="max-w-xs text-right mt-8 md:mt-0">
                    <p class="text-xs font-sans leading-relaxed text-deep-forest/70">
                        A proprietary allocation model transforming your hydration into global water security infrastructure.
                    </p>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-px bg-deep-forest/10 border border-deep-forest/10">
                <!-- Step 1 -->
                <div class="bg-coco-linen p-12 hover:bg-white transition-colors duration-700 group aspect-square flex flex-col justify-between">
                    <span class="text-[10px] uppercase tracking-widest opacity-30 group-hover:opacity-100 transition-opacity">01 — Selection</span>
                    <div class="self-center opacity-80 group-hover:scale-110 transition-transform duration-1000">
                        <i data-lucide="droplet" class="w-8 h-8 text-deep-forest stroke-[1px]"></i>
                    </div>
                    <p class="text-sm font-serif italic text-center text-deep-forest/60">You select Pure Coco.</p>
                </div>

                <!-- Step 2 -->
                <div class="bg-coco-linen p-12 hover:bg-white transition-colors duration-700 group aspect-square flex flex-col justify-between">
                    <span class="text-[10px] uppercase tracking-widest opacity-30 group-hover:opacity-100 transition-opacity">02 — Allocation</span>
                    <div class="self-center opacity-80 group-hover:scale-110 transition-transform duration-1000">
                        <i data-lucide="arrow-right-left" class="w-8 h-8 text-deep-forest stroke-[1px]"></i>
                    </div>
                    <p class="text-sm font-serif italic text-center text-deep-forest/60">Capital flows to infrastructure.</p>
                </div>

                <!-- Step 3 -->
                <div class="bg-coco-linen p-12 hover:bg-white transition-colors duration-700 group aspect-square flex flex-col justify-between">
                    <span class="text-[10px] uppercase tracking-widest opacity-30 group-hover:opacity-100 transition-opacity">03 — Impact</span>
                    <div class="self-center opacity-80 group-hover:scale-110 transition-transform duration-1000">
                        <i data-lucide="globe" class="w-8 h-8 text-deep-forest stroke-[1px]"></i>
                    </div>
                    <p class="text-sm font-serif italic text-center text-deep-forest/60">Resilient water systems built.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- 4. COLLECTION (Dark Mode Contrast) -->
    <section id="product" class="relative py-40 z-10 bg-deep-forest text-coco-linen overflow-hidden">
        <!-- Subtle noise on dark bg -->
        <div class="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/stardust.png')]"></div>

        <div class="max-w-7xl mx-auto px-6 relative z-10">
            <div class="text-center mb-24">
                <span class="text-champagne text-[9px] tracking-editorial uppercase block mb-4">The Collection</span>
                <h2 class="text-5xl font-serif italic">Elevate Your Ritual</h2>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-24">
                <!-- Single Can -->
                <div class="group cursor-pointer">
                    <div class="glass-panel-dark h-[500px] rounded-t-full relative overflow-hidden flex items-center justify-center transition-all duration-700 group-hover:bg-white/5 border border-white/5">
                        <!-- Abstract shape/glow behind product -->
                        <div class="absolute w-64 h-64 bg-hydro-teal/10 rounded-full blur-[80px] group-hover:bg-hydro-teal/20 transition-all duration-1000"></div>
                        <div class="relative z-10 text-center">
                            <h3 class="text-6xl font-serif italic mb-2">Solo</h3>
                            <p class="text-[10px] uppercase tracking-editorial text-champagne">The Introduction</p>
                        </div>
                    </div>
                    <div class="flex justify-between items-end mt-6 border-b border-white/10 pb-4">
                        <div>
                            <p class="text-sm font-sans tracking-wide">Single Unit</p>
                            <p class="text-xs text-white/40 mt-1">355ml • 12oz</p>
                        </div>
                        <span class="text-xl font-serif italic">$3.50</span>
                    </div>
                </div>

                <!-- 12 Pack -->
                <div class="group cursor-pointer">
                    <div class="glass-panel-dark h-[500px] rounded-t-full relative overflow-hidden flex items-center justify-center transition-all duration-700 group-hover:bg-white/5 border border-white/5">
                        <div class="absolute w-64 h-64 bg-champagne/10 rounded-full blur-[80px] group-hover:bg-champagne/20 transition-all duration-1000"></div>
                        <div class="relative z-10 text-center">
                            <h3 class="text-6xl font-serif italic mb-2">Case</h3>
                            <p class="text-[10px] uppercase tracking-editorial text-champagne">The Commitment</p>
                        </div>
                        <div class="absolute top-8 right-8 text-[9px] border border-champagne text-champagne px-3 py-1 rounded-full uppercase tracking-widest">
                            Privilege
                        </div>
                    </div>
                    <div class="flex justify-between items-end mt-6 border-b border-white/10 pb-4">
                        <div>
                            <p class="text-sm font-sans tracking-wide">12 Unit Case</p>
                            <p class="text-xs text-white/40 mt-1">Impact Multiplier</p>
                        </div>
                        <span class="text-xl font-serif italic">$36.00</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 5. HYDRATION COACH (Editorial Layout) -->
    <section id="coach" class="relative py-40 z-10 bg-coco-linen">
        <div class="max-w-5xl mx-auto px-6 grid grid-cols-1 lg:grid-cols-2 gap-20">
            <div>
                <span class="text-[9px] uppercase tracking-editorial text-deep-forest/40 mb-6 block">Artificial Intelligence</span>
                <h2 class="text-6xl font-serif text-deep-forest mb-8 leading-tight">
                    Precision <br> <span class="italic text-hydro-teal">Hydration.</span>
                </h2>
                <p class="text-sm text-deep-forest/70 leading-relaxed max-w-sm mb-12">
                    Leveraging the Gemini engine to architect a hydration protocol tailored to your biometrics and environment.
                </p>
                
                <div class="space-y-8">
                    <div class="border-b border-deep-forest/10 pb-2">
                        <label class="text-[9px] uppercase tracking-widest text-deep-forest/40 block mb-2">Mass (kg)</label>
                        <input type="number" id="coach-weight" value="70" class="w-full bg-transparent text-3xl font-serif text-deep-forest focus:outline-none placeholder-deep-forest/20">
                    </div>
                    
                    <div class="border-b border-deep-forest/10 pb-2">
                        <label class="text-[9px] uppercase tracking-widest text-deep-forest/40 block mb-2">Climate Profile</label>
                        <select id="coach-climate" class="w-full bg-transparent text-2xl font-serif text-deep-forest focus:outline-none cursor-pointer">
                            <option>Temperate</option>
                            <option>Tropical</option>
                            <option>Arid</option>
                            <option>Alpine</option>
                        </select>
                    </div>

                    <div class="border-b border-deep-forest/10 pb-2">
                        <label class="text-[9px] uppercase tracking-widest text-deep-forest/40 block mb-2">Exertion Level</label>
                        <select id="coach-activity" class="w-full bg-transparent text-2xl font-serif text-deep-forest focus:outline-none cursor-pointer">
                            <option>Sedentary</option>
                            <option selected>Moderate</option>
                            <option>High Performance</option>
                        </select>
                    </div>

                    <button onclick="generateHydrationAdvice()" id="coach-button" class="mt-8 group flex items-center gap-4 text-xs font-bold uppercase tracking-editorial text-deep-forest hover:text-hydro-teal transition-colors duration-500">
                        <span class="border-b border-current pb-1">Generate Protocol</span>
                        <i data-lucide="arrow-right" class="w-4 h-4 transition-transform group-hover:translate-x-2"></i>
                    </button>
                </div>
            </div>

            <div class="relative mt-12 lg:mt-0">
                <!-- Result Card -->
                <div class="glass-panel p-12 h-full min-h-[400px] flex flex-col justify-between">
                    <div id="coach-loading" class="hidden h-full flex items-center justify-center">
                         <div class="animate-pulse text-xs font-serif italic text-deep-forest/40">Consulting...</div>
                    </div>

                    <div id="coach-results" class="hidden h-full flex flex-col">
                        <span class="text-[9px] uppercase tracking-editorial text-hydro-teal mb-8">Your Protocol</span>
                        <div id="advice-text" class="text-xl font-serif leading-relaxed text-deep-forest mb-8"></div>
                        <div id="advice-sources" class="mt-auto pt-8 border-t border-deep-forest/5 text-[9px] text-deep-forest/40 uppercase tracking-widest"></div>
                    </div>
                    
                    <!-- Default State -->
                    <div id="coach-default" class="h-full flex items-center justify-center text-center">
                         <p class="text-3xl font-serif italic text-deep-forest/10">Input Data<br>For Analysis</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 6. FOOTER (Black Tie) -->
    <section id="shop" class="relative py-32 bg-deep-forest text-coco-linen border-t border-white/5">
        <div class="max-w-7xl mx-auto px-6 flex flex-col md:flex-row justify-between items-start md:items-center">
            
            <div class="mb-16 md:mb-0">
                <h2 class="text-4xl md:text-6xl font-serif italic mb-6">Join the Movement.</h2>
                <form action="mailto:hello@purecoco.io" method="POST" enctype="text/plain" class="flex gap-4 border-b border-white/20 pb-4 max-w-md hover:border-white/60 transition-colors duration-500">
                    <input type="email" placeholder="email address" class="bg-transparent text-coco-linen placeholder-white/20 w-full focus:outline-none text-sm tracking-wide">
                    <button type="submit" class="text-[10px] uppercase tracking-editorial font-bold hover:text-champagne transition-colors">Submit</button>
                </form>
            </div>

            <div class="grid grid-cols-2 gap-12 text-[10px] font-bold tracking-editorial uppercase text-white/40">
                <div class="flex flex-col gap-4">
                    <a href="#" class="hover:text-white transition-colors">Instagram</a>
                    <a href="#" class="hover:text-white transition-colors">Twitter</a>
                    <a href="#" class="hover:text-white transition-colors">LinkedIn</a>
                </div>
                <div class="flex flex-col gap-4">
                    <a href="#" class="hover:text-white transition-colors">Transparency</a>
                    <a href="#" class="hover:text-white transition-colors">Impact Report</a>
                    <a href="#" class="hover:text-white transition-colors">Wholesale</a>
                </div>
            </div>
        </div>
        <div class="max-w-7xl mx-auto px-6 mt-24 pt-8 border-t border-white/5 flex justify-between items-center text-[9px] text-white/20 uppercase tracking-widest">
            <p>&copy; 2025 Pure Coco</p>
            <p>Designed for Earth</p>
        </div>
    </section>

    <!-- SCRIPTS -->
    <script>
        // --- 1. LOADER ---
        window.addEventListener('load', () => {
            const loader = document.getElementById('loader-overlay');
            const line = document.querySelector('.loader-line');
            line.style.width = '100%';
            
            setTimeout(() => {
                loader.style.opacity = '0';
                setTimeout(() => loader.remove(), 1000);
            }, 1200);
        });

        // --- 2. ICONS ---
        lucide.createIcons();

        // --- 3. THREE.JS & LUXURY SHADERS ---
        const canvas = document.querySelector('#webgl-canvas');
        const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true, powerPreference: "high-performance" });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(40, window.innerWidth / window.innerHeight, 0.1, 100);
        camera.position.set(0, 0, 6);

        // --- MOUSE & PARALLAX ---
        const mouse = new THREE.Vector2();
        const targetMouse = new THREE.Vector2();
        window.addEventListener('mousemove', (e) => {
            targetMouse.x = (e.clientX / window.innerWidth) * 2 - 1;
            targetMouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
        });

        // --- A. CHROMATIC FLUID BACKGROUND ---
        const bgGeometry = new THREE.PlaneGeometry(25, 25, 64, 64);
        
        const bgFragmentShader = `
            uniform float uTime;
            uniform vec2 uMouse;
            varying vec2 vUv;

            // Simplex Noise (Standard)
            vec3 permute(vec3 x) { return mod(((x*34.0)+1.0)*x, 289.0); }
            float snoise(vec2 v){
                const vec4 C = vec4(0.211324865405187, 0.366025403784439, -0.577350269189626, 0.024390243902439);
                vec2 i  = floor(v + dot(v, C.yy) );
                vec2 x0 = v -   i + dot(i, C.xx);
                vec2 i1;
                i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
                vec4 x12 = x0.xyxy + C.xxzz;
                x12.xy -= i1;
                i = mod(i, 289.0);
                vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 )) + i.x + vec3(0.0, i1.x, 1.0 ));
                vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
                m = m*m ;
                m = m*m ;
                vec3 x = 2.0 * fract(p * C.www) - 1.0;
                vec3 h = abs(x) - 0.5;
                vec3 ox = floor(x + 0.5);
                vec3 a0 = x - ox;
                m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );
                vec3 g;
                g.x  = a0.x  * x0.x  + h.x  * x0.y;
                g.yz = a0.yz * x12.xz + h.yz * x12.yw;
                return 130.0 * dot(m, g);
            }

            void main() {
                vec2 uv = vUv;
                
                // Slow, elegant movement
                float t = uTime * 0.08;
                
                float n1 = snoise(uv * 2.0 + t);
                float n2 = snoise(uv * 4.0 - t * 1.5);
                
                // Mouse ripple
                float dist = distance(uv, uMouse * 0.5 + 0.5);
                float ripple = sin(dist * 10.0 - uTime * 2.0) * exp(-dist * 3.0) * 0.05;

                float finalNoise = mix(n1, n2, 0.5) + ripple;
                
                // Chromatic Aberration simulation by offsetting color channels
                float r = smoothstep(0.3, 0.7, finalNoise + 0.01);
                float g = smoothstep(0.3, 0.7, finalNoise);
                float b = smoothstep(0.3, 0.7, finalNoise - 0.01);
                
                // Palette: Linen base with Champagne and Teal hints
                vec3 cBase = vec3(0.96, 0.95, 0.92); // Linen
                vec3 cAccent = vec3(0.85, 0.78, 0.69); // Champagne
                vec3 cShadow = vec3(0.8, 0.85, 0.83); // Cool shadow

                vec3 color = mix(cBase, cAccent, r * 0.4);
                color = mix(color, cShadow, b * 0.2);
                
                // Add "Grain" / noise
                float noiseGrain = fract(sin(dot(uv, vec2(12.9898, 78.233))) * 43758.5453);
                color -= noiseGrain * 0.03;

                gl_FragColor = vec4(color, 1.0);
            }
        `;

        const bgMaterial = new THREE.ShaderMaterial({
            vertexShader: `
                varying vec2 vUv;
                void main() {
                    vUv = uv;
                    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
                }
            `,
            fragmentShader: bgFragmentShader,
            uniforms: {
                uTime: { value: 0 },
                uMouse: { value: new THREE.Vector2(0,0) }
            },
            depthWrite: false,
        });
        const bgMesh = new THREE.Mesh(bgGeometry, bgMaterial);
        bgMesh.position.z = -3;
        scene.add(bgMesh);

        // --- B. THE CAN (Brushed Aluminum & Gold Rim) ---
        const canGeometry = new THREE.CylinderGeometry(0.7, 0.7, 2.4, 64, 1, true);
        const topCapGeo = new THREE.CylinderGeometry(0.7, 0.7, 0.05, 64);
        const bottomCapGeo = new THREE.CylinderGeometry(0.7, 0.7, 0.05, 64);

        const canFragmentShader = `
            varying vec2 vUv;
            varying vec3 vNormal;
            varying vec3 vViewPosition;
            
            void main() {
                vec3 normal = normalize(vNormal);
                vec3 viewDir = normalize(vViewPosition);
                vec3 reflection = reflect(-viewDir, normal);
                
                // High contrast metallic env map
                float metal = dot(reflection, vec3(0.2, 1.0, 0.2)) * 0.5 + 0.5;
                metal = pow(metal, 4.0); 
                
                // Label Logic (Minimalist Design)
                vec3 baseColor = vec3(0.95, 0.95, 0.94); // Off white label
                
                // Vertical Strip (Teal)
                if (vUv.x > 0.45 && vUv.x < 0.55) {
                    baseColor = vec3(0.1, 0.15, 0.12); // Dark strip
                }
                
                // Gold Rim light (Fresnel)
                float fresnel = pow(1.0 - dot(viewDir, normal), 3.0);
                vec3 gold = vec3(0.85, 0.78, 0.50);
                
                vec3 finalColor = mix(baseColor, vec3(1.0), metal * 0.4);
                finalColor += gold * fresnel * 0.6; // Gold rim glow

                gl_FragColor = vec4(finalColor, 1.0);
            }
        `;

        const canMaterial = new THREE.ShaderMaterial({
            vertexShader: `
                varying vec2 vUv;
                varying vec3 vNormal;
                varying vec3 vViewPosition;
                void main() {
                    vUv = uv;
                    vNormal = normalize(normalMatrix * normal);
                    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
                    vViewPosition = -mvPosition.xyz;
                    gl_Position = projectionMatrix * mvPosition;
                }
            `,
            fragmentShader: canFragmentShader,
        });

        const capMaterial = new THREE.MeshPhysicalMaterial({
            color: 0xeeeeee,
            metalness: 1.0,
            roughness: 0.15,
            clearcoat: 1.0
        });

        const canBody = new THREE.Mesh(canGeometry, canMaterial);
        const topCap = new THREE.Mesh(topCapGeo, capMaterial);
        topCap.position.y = 1.225;
        const bottomCap = new THREE.Mesh(bottomCapGeo, capMaterial);
        bottomCap.position.y = -1.225;

        const canGroup = new THREE.Group();
        canGroup.add(canBody);
        canGroup.add(topCap);
        canGroup.add(bottomCap);
        
        canGroup.rotation.z = 0.15;
        canGroup.rotation.x = 0.1;
        
        scene.add(canGroup);

        // --- C. PARTICLES (Champagne Bubbles) ---
        const particlesGeo = new THREE.BufferGeometry();
        const particleCount = 150;
        const posArray = new Float32Array(particleCount * 3);
        
        for(let i = 0; i < particleCount * 3; i++) {
            posArray[i] = (Math.random() - 0.5) * 12;
        }
        
        particlesGeo.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
        const particlesMat = new THREE.PointsMaterial({
            size: 0.04,
            color: 0xD8C8B0, // Champagne
            transparent: true,
            opacity: 0.8,
            blending: THREE.AdditiveBlending
        });
        const particleSystem = new THREE.Points(particlesGeo, particlesMat);
        particleSystem.position.y = -5;
        scene.add(particleSystem);


        // --- 4. ANIMATION LOOP ---
        const clock = new THREE.Clock();

        function animate() {
            const time = clock.getElapsedTime();
            
            // Smooth mouse lerp
            mouse.lerp(targetMouse, 0.05);

            // Shader updates
            bgMaterial.uniforms.uTime.value = time;
            bgMaterial.uniforms.uMouse.value = mouse;

            // Physics feel for can (laggy rotation)
            canGroup.position.y += Math.cos(time * 0.5) * 0.001;
            canGroup.rotation.y += 0.003;
            
            // Subtle tilt based on mouse X
            canGroup.rotation.z = 0.15 + (mouse.x * 0.05);

            particleSystem.rotation.y = time * 0.05;
            particleSystem.position.y += Math.sin(time) * 0.001;

            renderer.render(scene, camera);
            requestAnimationFrame(animate);
        }
        animate();

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // --- 5. GSAP SCROLL (Cinematic) ---
        gsap.registerPlugin(ScrollTrigger);

        // Hero Text Reveal
        gsap.to(".reveal-text", {
            y: 0,
            opacity: 1,
            stagger: 0.25,
            duration: 2,
            ease: "power4.out",
            delay: 1.2
        });

        const tl = gsap.timeline({
            scrollTrigger: {
                trigger: "body",
                start: "top top",
                end: "bottom bottom",
                scrub: 1.2 // Slower scrub for heavier feel
            }
        });

        // Section 1: Can moves Left, rotates
        tl.to(canGroup.position, {
            x: -2.5,
            y: 0,
            z: 0.5,
            duration: 6,
            ease: "power2.inOut"
        }, "start")
        .to(canGroup.rotation, {
            y: Math.PI * 0.5,
            duration: 6
        }, "start")
        .to(".benefit-card", {
            opacity: 1,
            y: 0,
            duration: 4,
            ease: "power2.out"
        }, "start+=3");

        // Section 2: Can centers, Particles rise like bubbles
        tl.to(canGroup.position, {
            x: 0,
            y: 1.5,
            z: -1,
            duration: 6
        }, "impact")
        .to(canGroup.rotation, {
            x: 0.5,
            y: Math.PI,
            duration: 6
        }, "impact")
        .to(particleSystem.position, {
            y: 0,
            duration: 6
        }, "impact");

        // Section 3: Product View
        tl.to(canGroup.position, {
            y: -15, // Exit stage
            duration: 5
        }, "products");


        // --- 6. GEMINI API (Coach) ---
        const apiKey = ""; // Set API Key Here
        
        async function fetchWithRetry(url, options, maxRetries = 3) {
            for (let i = 0; i < maxRetries; i++) {
                try {
                    const response = await fetch(url, options);
                    if (!response.ok) throw new Error(response.status);
                    return response;
                } catch (error) {
                    if (i === maxRetries - 1) throw error;
                    await new Promise(r => setTimeout(r, 1000 * Math.pow(2, i)));
                }
            }
        }

        window.generateHydrationAdvice = async function() {
            const weight = document.getElementById('coach-weight').value;
            const activity = document.getElementById('coach-activity').value;
            const climate = document.getElementById('coach-climate').value;
            
            const btn = document.getElementById('coach-button');
            const loading = document.getElementById('coach-loading');
            const results = document.getElementById('coach-results');
            const def = document.getElementById('coach-default');
            const textDisplay = document.getElementById('advice-text');
            const sourceDisplay = document.getElementById('advice-sources');

            // UI Loading
            btn.classList.add('opacity-50');
            def.classList.add('hidden');
            loading.classList.remove('hidden');
            results.classList.add('hidden');

            const prompt = `Act as an elite hydration consultant for a client weighing ${weight}kg, active level: ${activity}, in a ${climate} climate. 
            Provide:
            1. Daily Water Intake (Liters)
            2. One sentence on why Potassium (Electrolytes) is critical for them.
            Tone: Clinical, luxury, precise.`;

            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                tools: [{ "google_search": {} }]
            };

            try {
                const res = await fetchWithRetry(apiUrl, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(payload)
                });
                
                const data = await res.json();
                const text = data.candidates?.[0]?.content?.parts?.[0]?.text || "Consultation unavailable.";
                
                // Formatter
                textDisplay.innerHTML = text.replace(/\*\*(.*?)\*\*/g, '<span class="text-hydro-teal italic">$1</span>').replace(/\n/g, '<br>');
                
                // Sources
                const sources = data.candidates?.[0]?.groundingMetadata?.groundingAttributions || [];
                if (sources.length) {
                    sourceDisplay.innerHTML = "DATA SOURCE: " + sources.map((s,i) => `<a href="${s.web?.uri}" target="_blank" class="hover:text-hydro-teal underline decoration-dotted">[${i+1}]</a>`).join(' ');
                }

                loading.classList.add('hidden');
                results.classList.remove('hidden');
            } catch (e) {
                console.error(e);
                textDisplay.textContent = "System offline. Please attempt reconnection.";
                loading.classList.add('hidden');
                results.classList.remove('hidden');
            } finally {
                btn.classList.remove('opacity-50');
            }
        };

    </script>
</body>
</html>